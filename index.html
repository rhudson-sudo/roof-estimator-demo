<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Roof & Window Estimator (Internal)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{margin:0;background:#0b1020;color:#e7ecff;font-family:system-ui}
header{padding:14px;border-bottom:1px solid #22305f;background:#0b1020;position:sticky;top:0}
h1{font-size:18px;margin:0}
.wrap{max-width:1200px;margin:auto;padding:16px}
.card{background:#111836;border:1px solid #22305f;border-radius:12px;padding:14px;margin-bottom:14px}
h2{font-size:14px;margin:0 0 10px;color:#cfe0ff}
.row3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}
label{font-size:12px;color:#97a3c2}
input,select,textarea,button{
width:100%;padding:8px;border-radius:8px;border:1px solid #2a3b73;
background:#0b1230;color:#e7ecff
}
button{cursor:pointer}
button:hover{border-color:#5f85ff}
.mono{font-family:monospace}
.kpi{display:flex;justify-content:space-between;border:1px solid #22305f;border-radius:10px;padding:8px;margin-bottom:6px}
.big{font-size:22px;font-weight:700}
#map{height:450px;border-radius:12px;border:1px solid #22305f}
</style>
</head>

<body>
<header>
<h1>Roof & Window Estimator — Internal Tool</h1>
</header>

<div class="wrap">

<!-- JOB INFO -->
<div class="card">
<h2>Job Info</h2>
<div class="row3">
<input id="jobName" placeholder="Customer / Address">
<input id="estimator" placeholder="Estimator">
<input id="taxRate" type="number" placeholder="Tax %" value="0">
</div>
</div>

<!-- ROOF MEASURE -->
<div class="card">
<h2>Roof Measure (Google Maps)</h2>

<div class="row3">
<input id="addressSearch" placeholder="Search address">
<input id="measuredSqFtTotal" class="mono" readonly placeholder="Measured sq ft">
<select id="pitchAssist" onchange="applyPitchAssist()">
<option value="">Pitch Assist</option>
<option value="1.00">≤3/12</option>
<option value="1.10">4–5/12</option>
<option value="1.18">6–7/12</option>
<option value="1.30">8–9/12</option>
<option value="1.50">10–12/12</option>
</select>
</div>

<div class="row3" style="margin-top:8px">
<button onclick="startDrawing()">+ Draw Roof Part</button>
<button onclick="useMeasured()">Use Measured Area</button>
<button onclick="clearAll()">Clear All</button>
</div>

<div id="map"></div>
</div>

<!-- ROOF PRICING -->
<div class="card">
<h2>Roofing — GAF Timberline HDZ</h2>

<div class="row3">
<input id="roofArea" type="number" placeholder="Roof Area (sq ft)">
<select id="pitch" onchange="autoToggleSteepFromPitch()">
<option value="1.00">≤3/12</option>
<option value="1.10">4–5/12</option>
<option value="1.18">6–7/12</option>
<option value="1.30">8–9/12</option>
<option value="1.50">10–12/12</option>
</select>
<input id="roofWaste" type="number" value="10" placeholder="Waste %">
</div>

<div class="row3">
<input id="shinglePerSq" placeholder="HDZ Material $/sq">
<input id="roofLaborPerSq" placeholder="Labor $/sq">
<input id="tearOffPerSq" placeholder="Tear-off $/sq">
</div>
</div>

<!-- ADDERS -->
<div class="card">
<h2>Roof Adders</h2>

<div class="row3">
<select id="homeHeight" onchange="autoToggleHeightAdders()">
<option value="">Home Height</option>
<option value="1">1 Story</option>
<option value="2">2 Story</option>
<option value="3">3 Story</option>
</select>
<input id="adderSteepPerSq" placeholder="Steep $/sq">
<input id="adderHighPerSq" placeholder="High $/sq">
</div>

<div class="row3">
<label><input type="checkbox" id="adderSteep"> Steep</label>
<label><input type="checkbox" id="adderTwoStory"> Two-Story</label>
<label><input type="checkbox" id="adderHigh"> High / 3-Story</label>
</div>
</div>

<!-- WINDOWS -->
<div class="card">
<h2>Regency Windows</h2>

<div class="row3">
<input id="tier1Count" type="number" placeholder="Standard Qty">
<input id="tier1Unit" placeholder="$ per Window">
<input id="winLaborPer" placeholder="Labor per Window">
</div>
</div>

<!-- TOTALS -->
<div class="card">
<h2>Totals</h2>

<div class="kpi"><b>Roof Squares</b><span id="sqOut">0</span></div>
<div class="kpi"><b>Roof Cost</b><span id="roofOut">$0</span></div>
<div class="kpi"><b>Window Cost</b><span id="winOut">$0</span></div>
<div class="kpi"><b>Total</b><span class="big" id="grandOut">$0</span></div>
</div>

</div>

<!-- GOOGLE MAPS + LOGIC -->
<script>
let map,drawingManager,autocomplete,roofParts=[];
function initMap(){
map=new google.maps.Map(document.getElementById("map"),{
center:{lat:40.05,lng:-75.3},zoom:19,mapTypeId:"satellite"});
autocomplete=new google.maps.places.Autocomplete(
document.getElementById("addressSearch"),
{fields:["geometry"]});
autocomplete.addListener("place_changed",()=>{
const p=autocomplete.getPlace();if(p.geometry){map.panTo(p.geometry.location);map.setZoom(20);}});
drawingManager=new google.maps.drawing.DrawingManager({
drawingMode:null,drawingControl:false,
polygonOptions:{editable:true}});
drawingManager.setMap(map);
google.maps.event.addListener(drawingManager,"overlaycomplete",e=>{
roofParts.push(e.overlay);calcMeasured();});
}

function startDrawing(){drawingManager.setDrawingMode(google.maps.drawing.OverlayType.POLYGON);}
function clearAll(){roofParts.forEach(p=>p.setMap(null));roofParts=[];calcMeasured();}
function calcMeasured(){
let total=0;
roofParts.forEach(p=>{
total+=google.maps.geometry.spherical.computeArea(p.getPath())*10.7639;});
document.getElementById("measuredSqFtTotal").value=Math.round(total);
}
function useMeasured(){
document.getElementById("roofArea").value=document.getElementById("measuredSqFtTotal").value;
calc();}
function applyPitchAssist(){
document.getElementById("pitch").value=document.getElementById("pitchAssist").value;
autoToggleSteepFromPitch();calc();}
function autoToggleSteepFromPitch(){
document.getElementById("adderSteep").checked=parseFloat(pitch.value)>=1.3;
}
function autoToggleHeightAdders(){
const h=homeHeight.value;
adderTwoStory.checked=h>=2;
adderHigh.checked=h==3;
calc();}
function calc(){
const area=roofArea.value/100;
const pitchF=parseFloat(pitch.value);
const waste=1+(roofWaste.value/100);
const squares=area*pitchF*waste;
sqOut.innerText=squares.toFixed(2);

let labor=parseFloat(roofLaborPerSq.value||0);
if(adderSteep.checked) labor+=parseFloat(adderSteepPerSq.value||0);
if(adderHigh.checked) labor+=parseFloat(adderHighPerSq.value||0);

const roofCost=squares*(parseFloat(shinglePerSq.value||0)+labor+parseFloat(tearOffPerSq.value||0));
roofOut.innerText="$"+roofCost.toFixed(0);

const winCost=(tier1Count.value||0)*(parseFloat(tier1Unit.value||0)+parseFloat(winLaborPer.value||0));
winOut.innerText="$"+winCost.toFixed(0);

grandOut.innerText="$"+(roofCost+winCost).toFixed(0);
}
document.addEventListener("input",calc);
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY&libraries=drawing,geometry,places&callback=initMap" async defer></script>

</body>
</html>
